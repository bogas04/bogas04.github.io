<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><title>Monorepos, lets talk about it | Blog | Divjot Singh</title><meta name="title" content="Monorepos, lets talk about it | Blog | Divjot Singh"/><meta name="description" content="Recall the days when you were just introduced to git or a similar type ofversion control system. I‚Äôm guessing you must have faced some‚Ä¶"/><meta name="keywords" content="git, repository, monorepos, coding, lerna, javascript"/><meta property="og:type" content="website"/><meta property="og:url" content="https://bogas04.github.io/blog/monorepos-lets-talk-about-it-9-17-2019"/><meta property="og:title" content="Monorepos, lets talk about it | Blog | Divjot Singh"/><meta property="og:description" content="Recall the days when you were just introduced to git or a similar type ofversion control system. I‚Äôm guessing you must have faced some‚Ä¶"/><meta property="og:image" content="https://bogas04.github.io/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png"/><meta property="twitter:card" content="summary_large_image"/><meta property="twitter:url" content="https://bogas04.github.io/blog/monorepos-lets-talk-about-it-9-17-2019"/><meta property="twitter:title" content="Monorepos, lets talk about it | Blog | Divjot Singh"/><meta property="twitter:description" content="Recall the days when you were just introduced to git or a similar type ofversion control system. I‚Äôm guessing you must have faced some‚Ä¶"/><meta property="twitter:image" content="https://bogas04.github.io/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png"/><meta content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0,viewport-fit=cover" name="viewport"/><meta name="format-detection" content="telephone=no"/><meta name="apple-mobile-web-app-capable" content="yes"/><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/><meta content="#333333" name="theme-color"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/dae563b86f8ce3b7.css" as="style"/><link rel="stylesheet" href="/_next/static/css/dae563b86f8ce3b7.css" data-n-g=""/><link rel="preload" href="/_next/static/css/1bf7c882aa33b937.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1bf7c882aa33b937.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-d38be8d96a62f950.js" defer=""></script><script src="/_next/static/chunks/framework-7a7e500878b44665.js" defer=""></script><script src="/_next/static/chunks/main-270ef8e3038ac606.js" defer=""></script><script src="/_next/static/chunks/pages/_app-6a16c061dd9adf2e.js" defer=""></script><script src="/_next/static/chunks/664-339c0d1773136295.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5Bslug%5D-b7f326f34261df12.js" defer=""></script><script src="/_next/static/lnV_U0plb11oH-tl65SRr/_buildManifest.js" defer=""></script><script src="/_next/static/lnV_U0plb11oH-tl65SRr/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.11"></style></head><body><div id="__next"><style>
        main {
            position: relative;
            max-width: 56em;
            background-color: white;
            padding: 2em;
            margin: 0 auto;
            box-sizing: border-box;
        }

        img {
            width: 100%;
        }

        @media (prefers-color-scheme: dark) {
            body,
            main {
                background: #333;
                color: white;
            }

            a {
                color: lightsalmon;
            }
        }
    </style><main><style>
  .content h2 {
    font-size: 1.6em;
    margin: 1em 0;
    font-weight: 500;
  }

  .content h3 {
    font-size: 1.2em;
    margin: 0.8em 0;
    font-weight: 500;
  }

  .content video {
    max-width: 100%;
  }

  .content img,
  .content video,
  .content h4 {
    margin: 1em 0;
  }

  .content pre {
    padding: 10px;
    font-size: 20px;
    line-height: 26px;
    overflow-x: auto;
  } 

  .content pre code {
    background-color: initial;
  }

  blockquote {
    position: relative;
    font-style: italic;
  }

  blockquote::before {
    content: &quot;‚Äú&quot;;
    position: absolute;
    margin: -0.5em;
    color: #333333;
    font-size: 3em;
    left: 0;
    top: 0;
  }

  blockquote::after {
    content: &quot;‚Äù&quot;;
    position: absolute;
    margin: -0.5em;
    color: #333333;
    font-size: 3em;
    right: 0;
    bottom: 0;
  }

  blockquote + p &gt; a {
    display: flex;
    justify-content: flex-end;
  }

  blockquote + p &gt; a::before {
    content: &quot;‚Äî &quot;;
    white-space: pre;
  }

  @media (prefers-color-scheme: dark) {
    .content pre {
      color: black;
    }

    blockquote::after, blockquote::before {
      color: white;
    }
  }

  .content ul {
    line-height: 1.5;
  }

  .content li {
    margin: 0 0 0.5em 0;
  }
  h4 {
    text-transform: capitalize;
    margin-bottom: 2em;
  }
  h4 p{
    margin: 0.4em 0;
  }
  </style><h1>Monorepos, lets talk about it</h1><h4><a href="/">Divjot Singh</a> | <a href="/blog">Blog</a> |<!-- --> <!-- -->Tue Sep 17 2019<br/><p>git, repository, monorepos, coding, lerna, javascript</p></h4><div class="content"><p><img src="/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png" alt="Image credits: undraw"></p>
<p>Recall the days when you were just introduced to <code>git</code> or a similar type of version control system. I‚Äôm guessing you must have faced some friction initially, how it breaks your flow, how you just can‚Äôt merge to master without rebasing/merging changes in first.</p>
<p>Despite that, you might agree today that it‚Äôs actually very helpful in collaborating with the team, and those pain points were necessary to get here.</p>
<p>Monorepos are somewhat similar.</p>
<p>While git was solving problems around managing single codebase with multiple team members or just better versioning, Monorepo kind of does the same but for multiple projects/codebases.</p>
<h3 id="user-content-the-what"><a href="#the-what" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The what.</h3>
<blockquote>
<p>Is Monorepo that cool font I see on¬†Twitter?</p>
</blockquote>
<p><img src="/img/blog/1__ZzlBaQH6w1BgwZdo3bIYRQ.png" alt="Image credits: undraw"></p>
<p>Before diving into the topic, let‚Äôs first understand what Monorepo truly means. This is what Wikipedia has to say:</p>
<blockquote>
<p>In revision control systems, a Monorepo is a software development strategy where code for many projects are stored in the same repository.</p>
</blockquote>
<p>In other words, your ‚ÄòWork‚Äô folder is close to what a Monorepo would look like. It would have packages that deal with server, web app, native app, documentation, etc.</p>
<p>This is different from a ‚Äòmonolith‚Äô where all your application logic is<br>
centralized to one entry point as opposed to distributed services (microservices).</p>
<p>While code for various services would sit in a single repository, it doesn‚Äôt mean it would be deployed as a single entity, just like your ‚ÄòWork‚Äô folder. Individual projects have separate life-cycles.</p>
<h3 id="user-content-the-why"><a href="#the-why" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The why.</h3>
<blockquote>
<p>So, do I just <code>git add</code> my entire ‚ÄòWork‚Äô¬†folder?</p>
</blockquote>
<blockquote>
<p>‚ÄúWhy would you want to do this? Whatever happened to separation of concern?‚Äù</p>
</blockquote>
<p>There are several arguments both in favour and against Monorepos. And I don‚Äôt mean ‚ÄúOh Google uses it‚Äù kind of arguments. This blog will give a sneak-peek into our problems and Monorepo‚Äôs solutions to them.</p>
<p>Regardless, I recommend that you identify the problems your codebase is facing, and see if Monorepo is truly the answer to those.</p>
<h3 id="user-content-the-story"><a href="#the-story" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The story.</h3>
<p>Before moving to Monorepo, we as a team worked on 3 codebases at the same time;</p>
<ul>
<li><strong>dweb</strong> (Desktop website of Swiggy)</li>
<li><strong>mweb</strong> (Mobile website of Swiggy)</li>
<li><strong>service</strong> (API proxy NodeJS middleware, used by dweb and mweb)</li>
</ul>
<p>When I say work, I mean writing features, updating build pipeline, reviewing code and fixing bugs.</p>
<p>As the codebases grew, we recognized some patterns:</p>
<p><img src="/img/blog/1____L__bUfSLVT6EboXRO7SSGg.png" alt="Image credits:¬†undraw"></p>
<ul>
<li>Features written on mweb, while dissimilar enough to not to be dragged and dropped to dweb, held enough similarities to be broken into reusable parts.</li>
<li>Fixes that go on mweb are also needed on dweb.</li>
<li>Code reviewers often ended up reviewing the same code (between mweb and dweb) in a slightly different context.</li>
<li>Code review changes on dweb are also relevant to mweb</li>
<li>Changes to contracts of service, a common dependency, are also needed to be individually coded, tested, and reviewed.</li>
<li>Updating dependencies like <a href="https://reactjs.org/">React</a>/<a href="https://webpack.js.org/">Webpack</a>/<a href="https://babeljs.io/">Babel</a> becomes cumbersome between the two codebases.</li>
<li>Conventions are difficult to enforce between the three repositories. One has an older version of <a href="https://eslint.org/">ESLint</a>, one hasn‚Äôt been updated when new lint rules were added, one is still using old test runner.</li>
<li>Attempts to make a new repository to keep common code failed due to the amount of setup and code management. Imagine working with multiple team members on multiple repositories with multiple Pull Requests.</li>
</ul>
<p>As you can see, while the projects are very different (check out <a href="https://portal-sentry.swiggyapp.com/settings/swiggy/go-front-staging/keys/">swiggy.com</a> on your desktop and mobile to realize that), they still have quite a lot of common code interactions.</p>
<blockquote>
<p>Bike-shedding: Have you tried <a href="https://www.swiggy.com?utm_source=medium">Swiggy</a> website on your desktop or mobile browser? We would love to hear your feedback!</p>
</blockquote>
<h3 id="user-content-the-how"><a href="#the-how" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The how.</h3>
<p><img src="/img/blog/1__0WjBWfdkbcob39FMklwp7A.png" alt="Logo of Lerna"></p>
<p><a href="https://lerna.js.org/">https://lerna.js.org/</a></p>
<p>Depending on your ecosystem, there will be different tools to help you with maintaining a Monorepo. You can obviously go vanilla and just use different folders per project. We use <a href="https://lerna.js.org/">Lerna</a> for maintaining our JavaScript codebase.</p>
<p>Thanks to its community, there‚Äôs a <a href="https://github.com/lerna/lerna/tree/master/commands/publish">lot</a> <a href="https://github.com/lerna/lerna/blob/master/FAQ.md">of</a> <a href="https://lerna.js.org/#commands">documentation</a> and <a href="https://medium.com/mitterio/multirepo-to-lerna-js-monorepo-80f6657cb443">help</a> for Lerna <a href="https://github.com/lerna/lerna/blob/master/doc/troubleshooting.md">related</a> <a href="https://github.com/lerna/lerna/blob/master/doc/guides.md">queries</a>.</p>
<div><pre><code><span># Install lerna globally</span>
<span>npm</span> i <span>-g</span> lerna

<span># Change directory to your work folder</span>
<span>cd</span> ~/Work

<span># Make the folder you want to keep your monorepo in</span>
<span>mkdir</span> portal-web

<span># Change directory to monorepo folder</span>
<span>cd</span> portal-web

<span># Initialize lerna (it will handle `git init`)</span>
lerna init

<span># Commit the changes</span>
<span>git</span> <span>add</span> <span>.</span> <span>&#x26;&#x26;</span> <span>git</span> commit <span>-m</span> <span>"Initial commit"</span>

<span># Import other packages (https://github.com/lerna/lerna/tree/master/commands/import)</span>
lerna <span>import</span> ~/Work/portal-mweb

<span># That's pretty much it!</span>

<span># Fun fact: If you want to rename your package, simply rename the folder before importing.</span>
<span># Fun fact 2: You might need to flatten out the commits in most cases (https://github.com/lerna/lerna/tree/master/commands/import#--flatten)</span>
</code></pre></div>
<p>You may use <a href="https://gist.github.com/bogas04/874731db80967c040209fea396bf7804">above scripts</a> to import existing repositories to a lerna based monorepo.</p>
<p>Running scripts from the root has been made simpler using these handy <a href="https://docs.npmjs.com/misc/scripts">npm scripts</a>.</p>
<p>These scripts allow for convenient way to invoke package scripts from root folder</p>
<p>Since our packages are hosted in <a href="https://verdaccio.org/">internal npm registry</a>, we inject a¬†.npmrc in our <a href="https://jenkins.io/">Jenkins</a> build the pipeline to avoid committing the authToken.</p>
<p>A script to find all scoped dependencies of a project</p>
<div><pre><code><span># Install monorepo dependencies from internal npm registry</span>
<span>npm</span> i <span><span>`</span><span>..</span>/<span>..</span>/scripts/scope-packages.js @portal<span>`</span></span>

<span># Fun fact:</span>
<span># `npm i &#x3C;package-name>` would also install other dependencies if they aren't present in node_modules,</span>
<span># along with the mentioned &#x3C;package-name></span>

<span># Fun fact 2:</span>
<span># In presence of package-lock.json, `npm i` would use those version numbers instead of fetching the latest ones</span>
<span># This essentially makes it a hybrid of `npm i` and `npm ci`</span>
</code></pre></div>
<p>One interesting thing about <a href="https://lerna.js.org/">Lerna</a> is that it <a href="https://gist.github.com/bogas04/8c9702aba064b03b1162a0058c7b8f98">doesn‚Äôt</a> want private packages to be part of the <code>package-lock.json.</code> This means we can‚Äôt just simply use <code>npm ci</code>. We use this bash script to get past that.</p>
<h3 id="user-content-the-happypart"><a href="#the-happypart" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The happy¬†part.</h3>
<p>Within a few months of making this change, we tippled the number of packages in our Monorepo. We also saw much more work done on the linting front, leading to a more consistent codebase.</p>
<p>The linter is common to entire Monorepo, and each new rule affects all the packages.</p>
<ul>
<li><strong>config</strong> (webpack config as a package, reused by mweb and dweb)</li>
<li><strong>ui</strong> (a package to create common patterns of design to be used in mobile and desktop, thus enabling us to work on creating a Swiggy‚Äôs design system)</li>
<li><strong>payments</strong> (a package of Swiggy‚Äôs payments page, used by multiple tenants)</li>
<li><strong>reviews</strong> (a package of Swiggy‚Äôs Ratings and Reviews page and components, used by mweb and dweb)</li>
<li><strong>helpers</strong> (a package of common reusable logic, something like lodash)</li>
<li><strong>daily</strong> (swiggydaily.com, reuses 2 components from mweb)</li>
<li><strong>cache</strong> (a caching module used by mweb and dweb)</li>
<li><strong>restaurant-url</strong> (a restaurant slug generator, multiple tenants)</li>
</ul>
<p><img src="/img/blog/1__kvwGrM__62LBXWLHxH__QwGw.png" alt="Image credits: undraw"></p>
<p>I think that giving the option to easily create a new package incentivizes developers to think in more modular terms. They don‚Äôt think in the context of an app but rather in a more general way.</p>
<p>It also discourages them from touching modules that are used by multiple tenants, and use <a href="https://semver.org/">semantic versioning</a> appropriately.</p>
<p>The benefits we are seeing out of this are just amazing:</p>
<ul>
<li>Writing the same fix for dweb and mweb is faster, as it‚Äôs just one commit.</li>
<li>No more <code>npm link</code> mess.</li>
<li>Reviewing a fix for both dweb and mweb is faster, as it‚Äôs just one Pull Request on one repository by one team member.</li>
<li>Reusing and updating build pipeline is much more seamless.</li>
<li>Updating major dependencies/lint rules is super easy.</li>
<li>The collocation of code encourages developers to copy-paste less and reuse more.</li>
<li>Writing reusable modules becomes easier, leading to better software engineering.</li>
</ul>
<h3 id="user-content-the-sadpart"><a href="#the-sadpart" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The sad¬†part.</h3>
<p>But it ain‚Äôt all fun. Our PR section is a bit noisier. It‚Äôs not like we‚Äôre somehow writing more code, but that changes to any package comes to spotlight and doesn‚Äôt get silently updated.</p>
<ul>
<li>Too many packages lead to longer bootstrap times.</li>
<li>Leveraging the benefits of Monorepo takes time.</li>
<li>The code navigation is slightly slower. Developers are now opening individual packages to work around that.</li>
</ul>
<p><strong>Update:</strong> There‚Äôs one more point I would like to touch upon. Our approach currently colocates applications with libraries. ‚Äòmweb‚Äô is a private package in the sense it isn‚Äôt published to our npm registry, however ‚Äòui‚Äô is a public package that can be consumed by mulitple tenants. This leads to heterogeneity in the monorepo. We are okay with this mix as</p>
<ul>
<li>it reduces friction of local development (no npm links).</li>
<li>colocation leads to easy refactors and library creations.</li>
<li>code review is simpler when it‚Äôs all one repository.</li>
</ul>
<h3 id="user-content-the-verdict"><a href="#the-verdict" aria-hidden="true" tabindex="-1"><span>üîó </span></a>The verdict.</h3>
<p>So far we‚Äôre seeing Monorepo architecture a better fit for our growing codebase and team. It also impacts the way we design new libraries and components, often promoting clearer separations of concerns.</p>
<p><img src="/img/blog/1__O3UIYiDjYTXMAZd7GBMwVg.png" alt="Image credits: undraw"></p>
<p>Should you use monorepo? Like all things, it depends on TM! I hope this blog gave enough insight to you as to why we started using a Monorepo, and how it‚Äôs benefiting us.</p>
<blockquote>
<p>DISCLAIMER: We don‚Äôt advocate for any of the tools, libraries, coding practices or software development philosophies mentioned here. You are welcome to read, learn, accept, reject and critique however you see¬†fit.</p>
</blockquote>
</div><footer style="border-top:1px solid black;margin-top:48px;padding-top:24px;padding-bottom:24px"><section style="display:flex;justify-content:space-between;align-items:center"><div>Like the article?</div><div>[<a href="https://github.com/bogas04/bogas04.github.io/blame/main/src/blog/Monorepos. Let‚Äôs talk about it.md" target="_blank">History</a>] [<a href="https://github.com/bogas04/bogas04.github.io/blob/main/src/blog/Monorepos. Let‚Äôs talk about it.md" target="_blank">Edit</a>]</div></section><div style="margin-top:24px"><nav style="display:flex;justify-content:space-between;align-items:center"><a href="https://twitter.com/intent/tweet/?text=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6&amp;url=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019" target="_blank" rel="noopener" aria-label="Tweet" title="Tweet" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm5.26 9.38v.34c0 3.48-2.64 7.5-7.48 7.5-1.48 0-2.87-.44-4.03-1.2 1.37.17 2.77-.2 3.9-1.08-1.16-.02-2.13-.78-2.46-1.83.38.1.8.07 1.17-.03-1.2-.24-2.1-1.3-2.1-2.58v-.05c.35.2.75.32 1.18.33-.7-.47-1.17-1.28-1.17-2.2 0-.47.13-.92.36-1.3C7.94 8.85 9.88 9.9 12.06 10c-.04-.2-.06-.4-.06-.6 0-1.46 1.18-2.63 2.63-2.63.76 0 1.44.3 1.92.82.6-.12 1.95-.27 1.95-.27-.35.53-.72 1.66-1.24 2.04z"></path></svg></a><a href="mailto:?subject=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6&amp;body=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019" target="_self" rel="noopener" aria-label="Mail" title="Mail" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><path d="M12 0C5.38 0 0 5.38 0 12s5.38 12 12 12 12-5.38 12-12S18.62 0 12 0zm8 16c0 1.1-.9 2-2 2H6c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2h12c1.1 0 2 .9 2 2v8z"></path><path d="M17.9 8.18c-.2-.2-.5-.24-.72-.07L12 12.38 6.82 8.1c-.22-.16-.53-.13-.7.08s-.15.53.06.7l3.62 2.97-3.57 2.23c-.23.14-.3.45-.15.7.1.14.25.22.42.22.1 0 .18-.02.27-.08l3.85-2.4 1.06.87c.1.04.2.1.32.1s.23-.06.32-.1l1.06-.9 3.86 2.4c.08.06.17.1.26.1.17 0 .33-.1.42-.25.15-.24.08-.55-.15-.7l-3.57-2.22 3.62-2.96c.2-.2.24-.5.07-.72z"></path></svg></a><a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019&amp;title=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6&amp;summary=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6&amp;source=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019" target="_blank" rel="noopener" aria-label="Share on LinkedIn" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1" title="Share on LinkedIn"><svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve"><path d="M12,0C5.383,0,0,5.383,0,12s5.383,12,12,12s12-5.383,12-12S18.617,0,12,0z M9.5,16.5h-2v-7h2V16.5z M8.5,7.5 c-0.553,0-1-0.448-1-1c0-0.552,0.447-1,1-1s1,0.448,1,1C9.5,7.052,9.053,7.5,8.5,7.5z M18.5,16.5h-3V13c0-0.277-0.225-0.5-0.5-0.5 c-0.276,0-0.5,0.223-0.5,0.5v3.5h-3c0,0,0.031-6.478,0-7h3v0.835c0,0,0.457-0.753,1.707-0.753c1.55,0,2.293,1.12,2.293,3.296V16.5z"></path></svg></a><a href="https://reddit.com/submit/?url=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019&amp;resubmit=true&amp;title=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6" target="_blank" rel="noopener" aria-label="Share on Reddit" title="Share on Reddit" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><circle cx="9.391" cy="13.392" r=".978"></circle><path d="M14.057 15.814c-1.14.66-2.987.655-4.122-.004-.238-.138-.545-.058-.684.182-.13.24-.05.545.19.685.72.417 1.63.646 2.568.646.93 0 1.84-.228 2.558-.642.24-.13.32-.44.185-.68-.14-.24-.445-.32-.683-.18zM5 12.086c0 .41.23.78.568.978.27-.662.735-1.264 1.353-1.774-.2-.207-.48-.334-.79-.334-.62 0-1.13.507-1.13 1.13z"></path><path d="M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12 12-5.383 12-12S18.617 0 12 0zm6.673 14.055c.01.104.022.208.022.314 0 2.61-3.004 4.73-6.695 4.73s-6.695-2.126-6.695-4.74c0-.105.013-.21.022-.313C4.537 13.73 4 12.97 4 12.08c0-1.173.956-2.13 2.13-2.13.63 0 1.218.29 1.618.757 1.04-.607 2.345-.99 3.77-1.063.057-.803.308-2.33 1.388-2.95.633-.366 1.417-.323 2.322.085.302-.81 1.076-1.397 1.99-1.397 1.174 0 2.13.96 2.13 2.13 0 1.177-.956 2.133-2.13 2.133-1.065 0-1.942-.79-2.098-1.81-.734-.4-1.315-.506-1.716-.276-.6.346-.818 1.395-.88 2.087 1.407.08 2.697.46 3.728 1.065.4-.468.987-.756 1.617-.756 1.17 0 2.13.953 2.13 2.13 0 .89-.54 1.65-1.33 1.97z"></path><circle cx="14.609" cy="13.391" r=".978"></circle><path d="M17.87 10.956c-.302 0-.583.128-.79.334.616.51 1.082 1.112 1.352 1.774.34-.197.568-.566.568-.978 0-.623-.507-1.13-1.13-1.13z"></path></svg></a><a href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019&amp;t=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6" target="_blank" rel="noopener" title="Share on HackerNews" aria-label="Share on HackerNews" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 256" width="24px" height="24px"><path fill-rule="evenodd" d="M128 256c70.692 0 128-57.308 128-128C256 57.308 198.692 0 128 0 57.308 0 0 57.308 0 128c0 70.692 57.308 128 128 128zm-9.06-113.686L75 60h20.08l25.85 52.093c.397.927.86 1.888 1.39 2.883.53.994.995 2.02 1.393 3.08.265.4.463.764.596 1.095.13.334.262.63.395.898.662 1.325 1.26 2.618 1.79 3.877.53 1.26.993 2.42 1.39 3.48 1.06-2.254 2.22-4.673 3.48-7.258 1.26-2.585 2.552-5.27 3.877-8.052L161.49 60h18.69l-44.34 83.308v53.087h-16.9v-54.08z"></path></svg></a><a href="https://telegram.me/share/url?text=Recall%20the%20days%20when%20you%20were%20just%20introduced%20to%20git%20or%20a%20similar%20type%20ofversion%20control%20system.%20I%E2%80%99m%20guessing%20you%20must%20have%20faced%20some%E2%80%A6&amp;url=https%3A%2F%2Fbogas04.github.io%2Fblog%2Fmonorepos-lets-talk-about-it-9-17-2019" target="_blank" rel="noopener" aria-label="Share on Telegram" title="Share on Telegram" style="height:40px;width:40px;display:flex;align-items:center;justify-content:center;border-radius:8px;border:2px solid black;padding:10px;background-color:white;fill:black;stoke:white;transition:0.5s ease-in;opacity:1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="24px" height="24px"><path d="M12 23.5c6.35 0 11.5-5.15 11.5-11.5S18.35.5 12 .5.5 5.65.5 12 5.65 23.5 12 23.5zM2.505 11.053c-.31.118-.505.738-.505.738s.203.62.513.737l3.636 1.355 1.417 4.557a.787.787 0 0 0 1.25.375l2.115-1.72a.29.29 0 0 1 .353-.01L15.1 19.85a.786.786 0 0 0 .746.095.786.786 0 0 0 .487-.573l2.793-13.426a.787.787 0 0 0-1.054-.893l-15.568 6z" fill-rule="evenodd"></path></svg></a></nav></div><div style="margin-top:24px"><div id="disqus_thread"></div></div></footer></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"Monorepos, lets talk about it","description":"Recall the days when you were just introduced to git or a similar type ofversion control system. I‚Äôm guessing you must have faced some‚Ä¶","date":"2019-09-17T07:55:58.095Z","categories":"[]","keywords":["git","repository","monorepos","coding","lerna","javascript"],"slug":"monorepos-lets-talk-about-it-9-17-2019","isDraft":false,"image":"/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png","html":"\u003cp\u003e\u003cimg src=\"/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png\" alt=\"Image credits: undraw\"\u003e\u003c/p\u003e\n\u003cp\u003eRecall the days when you were just introduced to \u003ccode\u003egit\u003c/code\u003e or a similar type of version control system. I‚Äôm guessing you must have faced some friction initially, how it breaks your flow, how you just can‚Äôt merge to master without rebasing/merging changes in first.\u003c/p\u003e\n\u003cp\u003eDespite that, you might agree today that it‚Äôs actually very helpful in collaborating with the team, and those pain points were necessary to get here.\u003c/p\u003e\n\u003cp\u003eMonorepos are somewhat similar.\u003c/p\u003e\n\u003cp\u003eWhile git was solving problems around managing single codebase with multiple team members or just better versioning, Monorepo kind of does the same but for multiple projects/codebases.\u003c/p\u003e\n\u003ch3 id=\"user-content-the-what\"\u003e\u003ca href=\"#the-what\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe what.\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIs Monorepo that cool font I see on¬†Twitter?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cimg src=\"/img/blog/1__ZzlBaQH6w1BgwZdo3bIYRQ.png\" alt=\"Image credits: undraw\"\u003e\u003c/p\u003e\n\u003cp\u003eBefore diving into the topic, let‚Äôs first understand what Monorepo truly means. This is what Wikipedia has to say:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIn revision control systems, a Monorepo is a software development strategy where code for many projects are stored in the same repository.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eIn other words, your ‚ÄòWork‚Äô folder is close to what a Monorepo would look like. It would have packages that deal with server, web app, native app, documentation, etc.\u003c/p\u003e\n\u003cp\u003eThis is different from a ‚Äòmonolith‚Äô where all your application logic is\u003cbr\u003e\ncentralized to one entry point as opposed to distributed services (microservices).\u003c/p\u003e\n\u003cp\u003eWhile code for various services would sit in a single repository, it doesn‚Äôt mean it would be deployed as a single entity, just like your ‚ÄòWork‚Äô folder. Individual projects have separate life-cycles.\u003c/p\u003e\n\u003ch3 id=\"user-content-the-why\"\u003e\u003ca href=\"#the-why\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe why.\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003eSo, do I just \u003ccode\u003egit add\u003c/code\u003e my entire ‚ÄòWork‚Äô¬†folder?\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cblockquote\u003e\n\u003cp\u003e‚ÄúWhy would you want to do this? Whatever happened to separation of concern?‚Äù\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003eThere are several arguments both in favour and against Monorepos. And I don‚Äôt mean ‚ÄúOh Google uses it‚Äù kind of arguments. This blog will give a sneak-peek into our problems and Monorepo‚Äôs solutions to them.\u003c/p\u003e\n\u003cp\u003eRegardless, I recommend that you identify the problems your codebase is facing, and see if Monorepo is truly the answer to those.\u003c/p\u003e\n\u003ch3 id=\"user-content-the-story\"\u003e\u003ca href=\"#the-story\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe story.\u003c/h3\u003e\n\u003cp\u003eBefore moving to Monorepo, we as a team worked on 3 codebases at the same time;\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003edweb\u003c/strong\u003e (Desktop website of Swiggy)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003emweb\u003c/strong\u003e (Mobile website of Swiggy)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eservice\u003c/strong\u003e (API proxy NodeJS middleware, used by dweb and mweb)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eWhen I say work, I mean writing features, updating build pipeline, reviewing code and fixing bugs.\u003c/p\u003e\n\u003cp\u003eAs the codebases grew, we recognized some patterns:\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/blog/1____L__bUfSLVT6EboXRO7SSGg.png\" alt=\"Image credits:¬†undraw\"\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eFeatures written on mweb, while dissimilar enough to not to be dragged and dropped to dweb, held enough similarities to be broken into reusable parts.\u003c/li\u003e\n\u003cli\u003eFixes that go on mweb are also needed on dweb.\u003c/li\u003e\n\u003cli\u003eCode reviewers often ended up reviewing the same code (between mweb and dweb) in a slightly different context.\u003c/li\u003e\n\u003cli\u003eCode review changes on dweb are also relevant to mweb\u003c/li\u003e\n\u003cli\u003eChanges to contracts of service, a common dependency, are also needed to be individually coded, tested, and reviewed.\u003c/li\u003e\n\u003cli\u003eUpdating dependencies like \u003ca href=\"https://reactjs.org/\"\u003eReact\u003c/a\u003e/\u003ca href=\"https://webpack.js.org/\"\u003eWebpack\u003c/a\u003e/\u003ca href=\"https://babeljs.io/\"\u003eBabel\u003c/a\u003e becomes cumbersome between the two codebases.\u003c/li\u003e\n\u003cli\u003eConventions are difficult to enforce between the three repositories. One has an older version of \u003ca href=\"https://eslint.org/\"\u003eESLint\u003c/a\u003e, one hasn‚Äôt been updated when new lint rules were added, one is still using old test runner.\u003c/li\u003e\n\u003cli\u003eAttempts to make a new repository to keep common code failed due to the amount of setup and code management. Imagine working with multiple team members on multiple repositories with multiple Pull Requests.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAs you can see, while the projects are very different (check out \u003ca href=\"https://portal-sentry.swiggyapp.com/settings/swiggy/go-front-staging/keys/\"\u003eswiggy.com\u003c/a\u003e on your desktop and mobile to realize that), they still have quite a lot of common code interactions.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eBike-shedding: Have you tried \u003ca href=\"https://www.swiggy.com?utm_source=medium\"\u003eSwiggy\u003c/a\u003e website on your desktop or mobile browser? We would love to hear your feedback!\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3 id=\"user-content-the-how\"\u003e\u003ca href=\"#the-how\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe how.\u003c/h3\u003e\n\u003cp\u003e\u003cimg src=\"/img/blog/1__0WjBWfdkbcob39FMklwp7A.png\" alt=\"Logo of Lerna\"\u003e\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://lerna.js.org/\"\u003ehttps://lerna.js.org/\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eDepending on your ecosystem, there will be different tools to help you with maintaining a Monorepo. You can obviously go vanilla and just use different folders per project. We use \u003ca href=\"https://lerna.js.org/\"\u003eLerna\u003c/a\u003e for maintaining our JavaScript codebase.\u003c/p\u003e\n\u003cp\u003eThanks to its community, there‚Äôs a \u003ca href=\"https://github.com/lerna/lerna/tree/master/commands/publish\"\u003elot\u003c/a\u003e \u003ca href=\"https://github.com/lerna/lerna/blob/master/FAQ.md\"\u003eof\u003c/a\u003e \u003ca href=\"https://lerna.js.org/#commands\"\u003edocumentation\u003c/a\u003e and \u003ca href=\"https://medium.com/mitterio/multirepo-to-lerna-js-monorepo-80f6657cb443\"\u003ehelp\u003c/a\u003e for Lerna \u003ca href=\"https://github.com/lerna/lerna/blob/master/doc/troubleshooting.md\"\u003erelated\u003c/a\u003e \u003ca href=\"https://github.com/lerna/lerna/blob/master/doc/guides.md\"\u003equeries\u003c/a\u003e.\u003c/p\u003e\n\u003cdiv\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan\u003e# Install lerna globally\u003c/span\u003e\n\u003cspan\u003enpm\u003c/span\u003e i \u003cspan\u003e-g\u003c/span\u003e lerna\n\n\u003cspan\u003e# Change directory to your work folder\u003c/span\u003e\n\u003cspan\u003ecd\u003c/span\u003e ~/Work\n\n\u003cspan\u003e# Make the folder you want to keep your monorepo in\u003c/span\u003e\n\u003cspan\u003emkdir\u003c/span\u003e portal-web\n\n\u003cspan\u003e# Change directory to monorepo folder\u003c/span\u003e\n\u003cspan\u003ecd\u003c/span\u003e portal-web\n\n\u003cspan\u003e# Initialize lerna (it will handle `git init`)\u003c/span\u003e\nlerna init\n\n\u003cspan\u003e# Commit the changes\u003c/span\u003e\n\u003cspan\u003egit\u003c/span\u003e \u003cspan\u003eadd\u003c/span\u003e \u003cspan\u003e.\u003c/span\u003e \u003cspan\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e \u003cspan\u003egit\u003c/span\u003e commit \u003cspan\u003e-m\u003c/span\u003e \u003cspan\u003e\"Initial commit\"\u003c/span\u003e\n\n\u003cspan\u003e# Import other packages (https://github.com/lerna/lerna/tree/master/commands/import)\u003c/span\u003e\nlerna \u003cspan\u003eimport\u003c/span\u003e ~/Work/portal-mweb\n\n\u003cspan\u003e# That's pretty much it!\u003c/span\u003e\n\n\u003cspan\u003e# Fun fact: If you want to rename your package, simply rename the folder before importing.\u003c/span\u003e\n\u003cspan\u003e# Fun fact 2: You might need to flatten out the commits in most cases (https://github.com/lerna/lerna/tree/master/commands/import#--flatten)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou may use \u003ca href=\"https://gist.github.com/bogas04/874731db80967c040209fea396bf7804\"\u003eabove scripts\u003c/a\u003e to import existing repositories to a lerna based monorepo.\u003c/p\u003e\n\u003cp\u003eRunning scripts from the root has been made simpler using these handy \u003ca href=\"https://docs.npmjs.com/misc/scripts\"\u003enpm scripts\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eThese scripts allow for convenient way to invoke package scripts from root folder\u003c/p\u003e\n\u003cp\u003eSince our packages are hosted in \u003ca href=\"https://verdaccio.org/\"\u003einternal npm registry\u003c/a\u003e, we inject a¬†.npmrc in our \u003ca href=\"https://jenkins.io/\"\u003eJenkins\u003c/a\u003e build the pipeline to avoid committing the authToken.\u003c/p\u003e\n\u003cp\u003eA script to find all scoped dependencies of a project\u003c/p\u003e\n\u003cdiv\u003e\u003cpre\u003e\u003ccode\u003e\u003cspan\u003e# Install monorepo dependencies from internal npm registry\u003c/span\u003e\n\u003cspan\u003enpm\u003c/span\u003e i \u003cspan\u003e\u003cspan\u003e`\u003c/span\u003e\u003cspan\u003e..\u003c/span\u003e/\u003cspan\u003e..\u003c/span\u003e/scripts/scope-packages.js @portal\u003cspan\u003e`\u003c/span\u003e\u003c/span\u003e\n\n\u003cspan\u003e# Fun fact:\u003c/span\u003e\n\u003cspan\u003e# `npm i \u0026#x3C;package-name\u003e` would also install other dependencies if they aren't present in node_modules,\u003c/span\u003e\n\u003cspan\u003e# along with the mentioned \u0026#x3C;package-name\u003e\u003c/span\u003e\n\n\u003cspan\u003e# Fun fact 2:\u003c/span\u003e\n\u003cspan\u003e# In presence of package-lock.json, `npm i` would use those version numbers instead of fetching the latest ones\u003c/span\u003e\n\u003cspan\u003e# This essentially makes it a hybrid of `npm i` and `npm ci`\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOne interesting thing about \u003ca href=\"https://lerna.js.org/\"\u003eLerna\u003c/a\u003e is that it \u003ca href=\"https://gist.github.com/bogas04/8c9702aba064b03b1162a0058c7b8f98\"\u003edoesn‚Äôt\u003c/a\u003e want private packages to be part of the \u003ccode\u003epackage-lock.json.\u003c/code\u003e This means we can‚Äôt just simply use \u003ccode\u003enpm ci\u003c/code\u003e. We use this bash script to get past that.\u003c/p\u003e\n\u003ch3 id=\"user-content-the-happypart\"\u003e\u003ca href=\"#the-happypart\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe happy¬†part.\u003c/h3\u003e\n\u003cp\u003eWithin a few months of making this change, we tippled the number of packages in our Monorepo. We also saw much more work done on the linting front, leading to a more consistent codebase.\u003c/p\u003e\n\u003cp\u003eThe linter is common to entire Monorepo, and each new rule affects all the packages.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003econfig\u003c/strong\u003e (webpack config as a package, reused by mweb and dweb)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eui\u003c/strong\u003e (a package to create common patterns of design to be used in mobile and desktop, thus enabling us to work on creating a Swiggy‚Äôs design system)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003epayments\u003c/strong\u003e (a package of Swiggy‚Äôs payments page, used by multiple tenants)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ereviews\u003c/strong\u003e (a package of Swiggy‚Äôs Ratings and Reviews page and components, used by mweb and dweb)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ehelpers\u003c/strong\u003e (a package of common reusable logic, something like lodash)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003edaily\u003c/strong\u003e (swiggydaily.com, reuses 2 components from mweb)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003ecache\u003c/strong\u003e (a caching module used by mweb and dweb)\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003erestaurant-url\u003c/strong\u003e (a restaurant slug generator, multiple tenants)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cimg src=\"/img/blog/1__kvwGrM__62LBXWLHxH__QwGw.png\" alt=\"Image credits: undraw\"\u003e\u003c/p\u003e\n\u003cp\u003eI think that giving the option to easily create a new package incentivizes developers to think in more modular terms. They don‚Äôt think in the context of an app but rather in a more general way.\u003c/p\u003e\n\u003cp\u003eIt also discourages them from touching modules that are used by multiple tenants, and use \u003ca href=\"https://semver.org/\"\u003esemantic versioning\u003c/a\u003e appropriately.\u003c/p\u003e\n\u003cp\u003eThe benefits we are seeing out of this are just amazing:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eWriting the same fix for dweb and mweb is faster, as it‚Äôs just one commit.\u003c/li\u003e\n\u003cli\u003eNo more \u003ccode\u003enpm link\u003c/code\u003e mess.\u003c/li\u003e\n\u003cli\u003eReviewing a fix for both dweb and mweb is faster, as it‚Äôs just one Pull Request on one repository by one team member.\u003c/li\u003e\n\u003cli\u003eReusing and updating build pipeline is much more seamless.\u003c/li\u003e\n\u003cli\u003eUpdating major dependencies/lint rules is super easy.\u003c/li\u003e\n\u003cli\u003eThe collocation of code encourages developers to copy-paste less and reuse more.\u003c/li\u003e\n\u003cli\u003eWriting reusable modules becomes easier, leading to better software engineering.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"user-content-the-sadpart\"\u003e\u003ca href=\"#the-sadpart\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe sad¬†part.\u003c/h3\u003e\n\u003cp\u003eBut it ain‚Äôt all fun. Our PR section is a bit noisier. It‚Äôs not like we‚Äôre somehow writing more code, but that changes to any package comes to spotlight and doesn‚Äôt get silently updated.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eToo many packages lead to longer bootstrap times.\u003c/li\u003e\n\u003cli\u003eLeveraging the benefits of Monorepo takes time.\u003c/li\u003e\n\u003cli\u003eThe code navigation is slightly slower. Developers are now opening individual packages to work around that.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eUpdate:\u003c/strong\u003e There‚Äôs one more point I would like to touch upon. Our approach currently colocates applications with libraries. ‚Äòmweb‚Äô is a private package in the sense it isn‚Äôt published to our npm registry, however ‚Äòui‚Äô is a public package that can be consumed by mulitple tenants. This leads to heterogeneity in the monorepo. We are okay with this mix as\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eit reduces friction of local development (no npm links).\u003c/li\u003e\n\u003cli\u003ecolocation leads to easy refactors and library creations.\u003c/li\u003e\n\u003cli\u003ecode review is simpler when it‚Äôs all one repository.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"user-content-the-verdict\"\u003e\u003ca href=\"#the-verdict\" aria-hidden=\"true\" tabindex=\"-1\"\u003e\u003cspan\u003eüîó \u003c/span\u003e\u003c/a\u003eThe verdict.\u003c/h3\u003e\n\u003cp\u003eSo far we‚Äôre seeing Monorepo architecture a better fit for our growing codebase and team. It also impacts the way we design new libraries and components, often promoting clearer separations of concerns.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"/img/blog/1__O3UIYiDjYTXMAZd7GBMwVg.png\" alt=\"Image credits: undraw\"\u003e\u003c/p\u003e\n\u003cp\u003eShould you use monorepo? Like all things, it depends on TM! I hope this blog gave enough insight to you as to why we started using a Monorepo, and how it‚Äôs benefiting us.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eDISCLAIMER: We don‚Äôt advocate for any of the tools, libraries, coding practices or software development philosophies mentioned here. You are welcome to read, learn, accept, reject and critique however you see¬†fit.\u003c/p\u003e\n\u003c/blockquote\u003e\n","fileName":"Monorepos. Let‚Äôs talk about it.md"}},"__N_SSG":true},"page":"/blog/[slug]","query":{"slug":"monorepos-lets-talk-about-it-9-17-2019"},"buildId":"lnV_U0plb11oH-tl65SRr","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>