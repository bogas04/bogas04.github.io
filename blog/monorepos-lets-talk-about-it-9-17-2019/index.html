<!doctype html> <html lang=en> <head> <meta charset=utf-8> <meta content="width=device-width,initial-scale=1" name=viewport> <meta content=#333333 name=theme-color> <base href=/ > <link href=global.css rel=stylesheet> <link href=manifest.json rel=manifest> <link href=favicon.png rel=icon type=image/png> <style>.progress.svelte-1uxc35n.svelte-1uxc35n{position:fixed;top:0;z-index:1000;height:4px;width:100%;border-radius:2px;background-clip:padding-box;overflow:hidden}.progress.svelte-1uxc35n .indeterminate.svelte-1uxc35n:before{content:'';position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:svelte-1uxc35n-indeterminate 2.1s cubic-bezier(.65,.815,.735,.395) infinite;animation:svelte-1uxc35n-indeterminate 2.1s cubic-bezier(.65,.815,.735,.395) infinite}.progress.svelte-1uxc35n .indeterminate.svelte-1uxc35n:after{content:'';position:absolute;background-color:inherit;top:0;left:0;bottom:0;will-change:left,right;-webkit-animation:svelte-1uxc35n-indeterminate-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;animation:svelte-1uxc35n-indeterminate-short 2.1s cubic-bezier(.165,.84,.44,1) infinite;-webkit-animation-delay:1.15s;animation-delay:1.15s}@-webkit-keyframes svelte-1uxc35n-indeterminate{0%{left:-35%;right:100%}60%{left:100%;right:-90%}100%{left:100%;right:-90%}}@keyframes svelte-1uxc35n-indeterminate{0%{left:-35%;right:100%}60%{left:100%;right:-90%}100%{left:100%;right:-90%}}@-webkit-keyframes svelte-1uxc35n-indeterminate-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}100%{left:107%;right:-8%}}@keyframes svelte-1uxc35n-indeterminate-short{0%{left:-200%;right:100%}60%{left:107%;right:-8%}100%{left:107%;right:-8%}}main.svelte-jcurac{position:relative;max-width:56em;background-color:#fff;padding:2em;margin:0 auto;box-sizing:border-box}img{width:100%}.content.svelte-1ycksgq h2{font-size:1.4em;font-weight:500}.content.svelte-1ycksgq pre{background-color:#f9f9f9;box-shadow:inset 1px 1px 5px rgba(0,0,0,.05);padding:.5em;border-radius:2px;overflow-x:auto}.content.svelte-1ycksgq pre code{background-color:transparent;padding:0}.content.svelte-1ycksgq ul{line-height:1.5}.content.svelte-1ycksgq li{margin:0 0 .5em 0}</style> <noscript id=sapper-head-start></noscript><title>Monorepos, lets talk about it | Blog | Divjot Singh</title><meta content="Monorepos, lets talk about it | Blog | Divjot Singh" name=title><meta content="Recall the days when you were just introduced to git or a similar type ofversion control system. I’m guessing you must have faced some…" name=description><meta content=website property=og:type><meta content=https://bogas04.github.io/blog/monorepos-lets-talk-about-it-9-17-2019 property=og:url><meta content="Monorepos, lets talk about it | Blog | Divjot Singh" property=og:title><meta content="Recall the days when you were just introduced to git or a similar type ofversion control system. I’m guessing you must have faced some…" property=og:description><meta content=https://bogas04.github.io/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png property=og:image><meta content=https://bogas04.github.io/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png property=twitter:card><meta content=https://bogas04.github.io/blog/monorepos-lets-talk-about-it-9-17-2019 property=twitter:url><meta content="Monorepos, lets talk about it | Blog | Divjot Singh" property=twitter:title><meta content="Recall the days when you were just introduced to git or a similar type ofversion control system. I’m guessing you must have faced some…" property=twitter:description><meta content=https://bogas04.github.io/img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png property=twitter:image><noscript id=sapper-head-end></noscript> </head> <body> <div id=sapper> <main> <main class=svelte-jcurac> <h1> <a href=/ >Divjot Singh</a> | <a href=/blog rel=preload>Blog</a> | Monorepos, lets talk about it </h1> <div class="content svelte-1ycksgq"> <img alt="Image credits: undraw" src=img/blog/1__zWhHZUDWuxJwfEoumC1__OQ.png><br>Recall the days when you were just introduced to <code>git</code> or a similar type of version control system. I’m guessing you must have faced some friction initially, how it breaks your flow, how you just can’t merge to master without rebasing/merging changes in first.<br>Despite that, you might agree today that it’s actually very helpful in collaborating with the team, and those pain points were necessary to get here.<br>Monorepos are somewhat similar.<br>While git was solving problems around managing single codebase with multiple team members or just better versioning, Monorepo kind of does the same but for multiple projects/codebases.<h3>The what.</h3><blockquote>Is Monorepo that cool font I see on Twitter?</blockquote><br><img alt="Image credits: undraw" src=img/blog/1__ZzlBaQH6w1BgwZdo3bIYRQ.png><br>Before diving into the topic, let’s first understand what Monorepo truly means. This is what Wikipedia has to say:<br><blockquote>In revision control systems, a Monorepo is a software development strategy where code for many projects are stored in the same repository.</blockquote><br>In other words, your ‘Work’ folder is close to what a Monorepo would look like. It would have packages that deal with server, web app, native app, documentation, etc.<br>This is different from a ‘monolith’ where all your application logic is<br>centralized to one entry point as opposed to distributed services (microservices).<br>While code for various services would sit in a single repository, it doesn’t mean it would be deployed as a single entity, just like your ‘Work’ folder. Individual projects have separate life-cycles.<h3>The why.</h3><blockquote>So, do I just <code>git add</code> my entire ‘Work’ folder?</blockquote><br><blockquote>“Why would you want to do this? Whatever happened to separation of concern?”</blockquote><br>There are several arguments both in favour and against Monorepos. And I don’t mean “Oh Google uses it” kind of arguments. This blog will give a sneak-peek into our problems and Monorepo’s solutions to them.<br>Regardless, I recommend that you identify the problems your codebase is facing, and see if Monorepo is truly the answer to those.<h3>The story.</h3>Before moving to Monorepo, we as a team worked on 3 codebases at the same time;<br><ul><li><strong>dweb</strong> (Desktop website of Swiggy)<li><strong>mweb</strong> (Mobile website of Swiggy)<li><strong>service</strong> (API proxy NodeJS middleware, used by dweb and mweb)</ul><br>When I say work, I mean writing features, updating build pipeline, reviewing code and fixing bugs.<br>As the codebases grew, we recognized some patterns:<br><img alt="Image credits: undraw" src=img/blog/1____L__bUfSLVT6EboXRO7SSGg.png><br><ul><li>Features written on mweb, while dissimilar enough to not to be dragged and dropped to dweb, held enough similarities to be broken into reusable parts.<li>Fixes that go on mweb are also needed on dweb.<li>Code reviewers often ended up reviewing the same code (between mweb and dweb) in a slightly different context.<li>Code review changes on dweb are also relevant to mweb<li>Changes to contracts of service, a common dependency, are also needed to be individually coded, tested, and reviewed.<li>Updating dependencies like <a href=https://reactjs.org/ >React</a>/<a href=https://webpack.js.org/ >Webpack</a>/<a href=https://babeljs.io/ >Babel</a> becomes cumbersome between the two codebases.<li>Conventions are difficult to enforce between the three repositories. One has an older version of <a href=https://eslint.org/ >ESLint</a>, one hasn’t been updated when new lint rules were added, one is still using old test runner.<li>Attempts to make a new repository to keep common code failed due to the amount of setup and code management. Imagine working with multiple team members on multiple repositories with multiple Pull Requests.</ul><br>As you can see, while the projects are very different (check out <a href=https://portal-sentry.swiggyapp.com/settings/swiggy/go-front-staging/keys/ >swiggy.com</a> on your desktop and mobile to realize that), they still have quite a lot of common code interactions.<br><blockquote>Bike-shedding: Have you tried <a href="https://www.swiggy.com?utm_source=medium">Swiggy</a> website on your desktop or mobile browser? We would love to hear your feedback!</blockquote><h3>The how.</h3><img alt="Logo of Lerna" src=img/blog/1__0WjBWfdkbcob39FMklwp7A.png><br><a href=https://lerna.js.org/ >https://lerna.js.org/</a><br>Depending on your ecosystem, there will be different tools to help you with maintaining a Monorepo. You can obviously go vanilla and just use different folders per project. We use <a href=https://lerna.js.org/ >Lerna</a> for maintaining our JavaScript codebase.<br>Thanks to its community, there’s a <a href=https://github.com/lerna/lerna/tree/master/commands/publish>lot</a> <a href=https://github.com/lerna/lerna/blob/master/FAQ.md>of</a> <a href=https://lerna.js.org/#commands>documentation</a> and <a href=https://medium.com/mitterio/multirepo-to-lerna-js-monorepo-80f6657cb443>help</a> for Lerna <a href=https://github.com/lerna/lerna/blob/master/doc/troubleshooting.md>related</a> <a href=https://github.com/lerna/lerna/blob/master/doc/guides.md>queries</a>.<br>You may use <a href=https://gist.github.com/bogas04/874731db80967c040209fea396bf7804>above scripts</a> to import existing repositories to a lerna based monorepo.<br>Running scripts from the root has been made simpler using these handy <a href=https://docs.npmjs.com/misc/scripts>npm scripts</a>.<br>These scripts allow for convenient way to invoke package scripts from root folder<br>Since our packages are hosted in <a href=https://verdaccio.org/ >internal npm registry</a>, we inject a .npmrc in our <a href=https://jenkins.io/ >Jenkins</a> build the pipeline to avoid committing the authToken.<br>A script to find all scoped dependencies of a project<br>One interesting thing about <a href=https://lerna.js.org/ >Lerna</a> is that it <a href=https://gist.github.com/bogas04/8c9702aba064b03b1162a0058c7b8f98>doesn’t</a> want private packages to be part of the <code>package-lock.json.</code> This means we can’t just simply use <code>npm ci</code>. We use this bash script to get past that.<h3>The happy part.</h3>Within a few months of making this change, we tippled the number of packages in our Monorepo. We also saw much more work done on the linting front, leading to a more consistent codebase.<br>The linter is common to entire Monorepo, and each new rule affects all the packages.<br><ul><li><strong>config</strong> (webpack config as a package, reused by mweb and dweb)<li><strong>ui</strong> (a package to create common patterns of design to be used in mobile and desktop, thus enabling us to work on creating a Swiggy’s design system)<li><strong>payments</strong> (a package of Swiggy’s payments page, used by multiple tenants)<li><strong>reviews</strong> (a package of Swiggy’s Ratings and Reviews page and components, used by mweb and dweb)<li><strong>helpers</strong> (a package of common reusable logic, something like lodash)<li><strong>daily</strong> (swiggydaily.com, reuses 2 components from mweb)<li><strong>cache</strong> (a caching module used by mweb and dweb)<li><strong>restaurant-url</strong> (a restaurant slug generator, multiple tenants)</ul><br><img alt="Image credits: undraw" src=img/blog/1__kvwGrM__62LBXWLHxH__QwGw.png><br>I think that giving the option to easily create a new package incentivizes developers to think in more modular terms. They don’t think in the context of an app but rather in a more general way.<br>It also discourages them from touching modules that are used by multiple tenants, and use <a href=https://semver.org/ >semantic versioning</a> appropriately.<br>The benefits we are seeing out of this are just amazing:<br><ul><li>Writing the same fix for dweb and mweb is faster, as it’s just one commit.<li>No more <code>npm link</code> mess.<li>Reviewing a fix for both dweb and mweb is faster, as it’s just one Pull Request on one repository by one team member.<li>Reusing and updating build pipeline is much more seamless.<li>Updating major dependencies/lint rules is super easy.<li>The collocation of code encourages developers to copy-paste less and reuse more.<li>Writing reusable modules becomes easier, leading to better software engineering.</ul><h3>The sad part.</h3>But it ain’t all fun. Our PR section is a bit noisier. It’s not like we’re somehow writing more code, but that changes to any package comes to spotlight and doesn’t get silently updated.<br><ul><li>Too many packages lead to longer bootstrap times.<li>Leveraging the benefits of Monorepo takes time.<li>The code navigation is slightly slower. Developers are now opening individual packages to work around that.</ul><br><strong>Update:</strong> There’s one more point I would like to touch upon. Our approach currently colocates applications with libraries. ‘mweb’ is a private package in the sense it isn’t published to our npm registry, however ‘ui’ is a public package that can be consumed by mulitple tenants. This leads to heterogeneity in the monorepo. We are okay with this mix as<br><ul><li>it reduces friction of local development (no npm links).<li>colocation leads to easy refactors and library creations.<li>code review is simpler when it’s all one repository.</ul><h3>The verdict.</h3>So far we’re seeing Monorepo architecture a better fit for our growing codebase and team. It also impacts the way we design new libraries and components, often promoting clearer separations of concerns.<br><img alt="Image credits: undraw" src=img/blog/1__O3UIYiDjYTXMAZd7GBMwVg.png><br>Should you use monorepo? Like all things, it depends on TM! I hope this blog gave enough insight to you as to why we started using a Monorepo, and how it’s benefiting us.<br><blockquote>DISCLAIMER: We don’t advocate for any of the tools, libraries, coding practices or software development philosophies mentioned here. You are welcome to read, learn, accept, reject and critique however you see fit.</blockquote> </div> </main> </main></div> <script>__SAPPER__={baseUrl:"",preloaded:[void 0,{},(function(a){return {post:{title:"Monorepos, lets talk about it",description:"Recall the days when you were just introduced to git or a similar type ofversion control system. I’m guessing you must have faced some…",date:"2019-09-17T07:55:58.095Z",categories:a,keywords:a,slug:"monorepos-lets-talk-about-it-9-17-2019",image:"img\u002Fblog\u002F1__zWhHZUDWuxJwfEoumC1__OQ.png",html:"\u003Cimg src=\"img\u002Fblog\u002F1__zWhHZUDWuxJwfEoumC1__OQ.png\" alt=\"Image credits: undraw\"\u003E\u003Cbr \u002F\u003ERecall the days when you were just introduced to \u003Ccode\u003Egit\u003C\u002Fcode\u003E or a similar type of version control system. I’m guessing you must have faced some friction initially, how it breaks your flow, how you just can’t merge to master without rebasing\u002Fmerging changes in first.\u003Cbr \u002F\u003EDespite that, you might agree today that it’s actually very helpful in collaborating with the team, and those pain points were necessary to get here.\u003Cbr \u002F\u003EMonorepos are somewhat similar.\u003Cbr \u002F\u003EWhile git was solving problems around managing single codebase with multiple team members or just better versioning, Monorepo kind of does the same but for multiple projects\u002Fcodebases.\u003Ch3\u003EThe what.\u003C\u002Fh3\u003E\u003Cblockquote\u003EIs Monorepo that cool font I see on Twitter?\u003C\u002Fblockquote\u003E\u003Cbr \u002F\u003E\u003Cimg src=\"img\u002Fblog\u002F1__ZzlBaQH6w1BgwZdo3bIYRQ.png\" alt=\"Image credits: undraw\"\u003E\u003Cbr \u002F\u003EBefore diving into the topic, let’s first understand what Monorepo truly means. This is what Wikipedia has to say:\u003Cbr \u002F\u003E\u003Cblockquote\u003EIn revision control systems, a Monorepo is a software development strategy where code for many projects are stored in the same repository.\u003C\u002Fblockquote\u003E\u003Cbr \u002F\u003EIn other words, your ‘Work’ folder is close to what a Monorepo would look like. It would have packages that deal with server, web app, native app, documentation, etc.\u003Cbr \u002F\u003EThis is different from a ‘monolith’ where all your application logic is\u003Cbr \u002F\u003Ecentralized to one entry point as opposed to distributed services (microservices).\u003Cbr \u002F\u003EWhile code for various services would sit in a single repository, it doesn’t mean it would be deployed as a single entity, just like your ‘Work’ folder. Individual projects have separate life-cycles.\u003Ch3\u003EThe why.\u003C\u002Fh3\u003E\u003Cblockquote\u003ESo, do I just \u003Ccode\u003Egit add\u003C\u002Fcode\u003E my entire ‘Work’ folder?\u003C\u002Fblockquote\u003E\u003Cbr \u002F\u003E\u003Cblockquote\u003E“Why would you want to do this? Whatever happened to separation of concern?”\u003C\u002Fblockquote\u003E\u003Cbr \u002F\u003EThere are several arguments both in favour and against Monorepos. And I don’t mean “Oh Google uses it” kind of arguments. This blog will give a sneak-peek into our problems and Monorepo’s solutions to them.\u003Cbr \u002F\u003ERegardless, I recommend that you identify the problems your codebase is facing, and see if Monorepo is truly the answer to those.\u003Ch3\u003EThe story.\u003C\u002Fh3\u003EBefore moving to Monorepo, we as a team worked on 3 codebases at the same time;\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003E\u003Cstrong\u003Edweb\u003C\u002Fstrong\u003E (Desktop website of Swiggy)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Emweb\u003C\u002Fstrong\u003E (Mobile website of Swiggy)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Eservice\u003C\u002Fstrong\u003E (API proxy NodeJS middleware, used by dweb and mweb)\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cbr \u002F\u003EWhen I say work, I mean writing features, updating build pipeline, reviewing code and fixing bugs.\u003Cbr \u002F\u003EAs the codebases grew, we recognized some patterns:\u003Cbr \u002F\u003E\u003Cimg src=\"img\u002Fblog\u002F1____L__bUfSLVT6EboXRO7SSGg.png\" alt=\"Image credits: undraw\"\u003E\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003EFeatures written on mweb, while dissimilar enough to not to be dragged and dropped to dweb, held enough similarities to be broken into reusable parts.\u003C\u002Fli\u003E\u003Cli\u003EFixes that go on mweb are also needed on dweb.\u003C\u002Fli\u003E\u003Cli\u003ECode reviewers often ended up reviewing the same code (between mweb and dweb) in a slightly different context.\u003C\u002Fli\u003E\u003Cli\u003ECode review changes on dweb are also relevant to mweb\u003C\u002Fli\u003E\u003Cli\u003EChanges to contracts of service, a common dependency, are also needed to be individually coded, tested, and reviewed.\u003C\u002Fli\u003E\u003Cli\u003EUpdating dependencies like \u003Ca href=\"https:\u002F\u002Freactjs.org\u002F\"\u003EReact\u003C\u002Fa\u003E\u002F\u003Ca href=\"https:\u002F\u002Fwebpack.js.org\u002F\"\u003EWebpack\u003C\u002Fa\u003E\u002F\u003Ca href=\"https:\u002F\u002Fbabeljs.io\u002F\"\u003EBabel\u003C\u002Fa\u003E becomes cumbersome between the two codebases.\u003C\u002Fli\u003E\u003Cli\u003EConventions are difficult to enforce between the three repositories. One has an older version of \u003Ca href=\"https:\u002F\u002Feslint.org\u002F\"\u003EESLint\u003C\u002Fa\u003E, one hasn’t been updated when new lint rules were added, one is still using old test runner.\u003C\u002Fli\u003E\u003Cli\u003EAttempts to make a new repository to keep common code failed due to the amount of setup and code management. Imagine working with multiple team members on multiple repositories with multiple Pull Requests.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cbr \u002F\u003EAs you can see, while the projects are very different (check out \u003Ca href=\"https:\u002F\u002Fportal-sentry.swiggyapp.com\u002Fsettings\u002Fswiggy\u002Fgo-front-staging\u002Fkeys\u002F\"\u003Eswiggy.com\u003C\u002Fa\u003E on your desktop and mobile to realize that), they still have quite a lot of common code interactions.\u003Cbr \u002F\u003E\u003Cblockquote\u003EBike-shedding: Have you tried \u003Ca href=\"https:\u002F\u002Fwww.swiggy.com?utm_source=medium\"\u003ESwiggy\u003C\u002Fa\u003E website on your desktop or mobile browser? We would love to hear your feedback!\u003C\u002Fblockquote\u003E\u003Ch3\u003EThe how.\u003C\u002Fh3\u003E\u003Cimg src=\"img\u002Fblog\u002F1__0WjBWfdkbcob39FMklwp7A.png\" alt=\"Logo of Lerna\"\u003E\u003Cbr \u002F\u003E\u003Ca href=\"https:\u002F\u002Flerna.js.org\u002F\"\u003Ehttps:\u002F\u002Flerna.js.org\u002F\u003C\u002Fa\u003E\u003Cbr \u002F\u003EDepending on your ecosystem, there will be different tools to help you with maintaining a Monorepo. You can obviously go vanilla and just use different folders per project. We use \u003Ca href=\"https:\u002F\u002Flerna.js.org\u002F\"\u003ELerna\u003C\u002Fa\u003E for maintaining our JavaScript codebase.\u003Cbr \u002F\u003EThanks to its community, there’s a \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flerna\u002Flerna\u002Ftree\u002Fmaster\u002Fcommands\u002Fpublish\"\u003Elot\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flerna\u002Flerna\u002Fblob\u002Fmaster\u002FFAQ.md\"\u003Eof\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Flerna.js.org\u002F#commands\"\u003Edocumentation\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fmedium.com\u002Fmitterio\u002Fmultirepo-to-lerna-js-monorepo-80f6657cb443\"\u003Ehelp\u003C\u002Fa\u003E for Lerna \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flerna\u002Flerna\u002Fblob\u002Fmaster\u002Fdoc\u002Ftroubleshooting.md\"\u003Erelated\u003C\u002Fa\u003E \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flerna\u002Flerna\u002Fblob\u002Fmaster\u002Fdoc\u002Fguides.md\"\u003Equeries\u003C\u002Fa\u003E.\u003Cbr \u002F\u003EYou may use \u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fbogas04\u002F874731db80967c040209fea396bf7804\"\u003Eabove scripts\u003C\u002Fa\u003E to import existing repositories to a lerna based monorepo.\u003Cbr \u002F\u003ERunning scripts from the root has been made simpler using these handy \u003Ca href=\"https:\u002F\u002Fdocs.npmjs.com\u002Fmisc\u002Fscripts\"\u003Enpm scripts\u003C\u002Fa\u003E.\u003Cbr \u002F\u003EThese scripts allow for convenient way to invoke package scripts from root folder\u003Cbr \u002F\u003ESince our packages are hosted in \u003Ca href=\"https:\u002F\u002Fverdaccio.org\u002F\"\u003Einternal npm registry\u003C\u002Fa\u003E, we inject a .npmrc in our \u003Ca href=\"https:\u002F\u002Fjenkins.io\u002F\"\u003EJenkins\u003C\u002Fa\u003E build the pipeline to avoid committing the authToken.\u003Cbr \u002F\u003EA script to find all scoped dependencies of a project\u003Cbr \u002F\u003EOne interesting thing about \u003Ca href=\"https:\u002F\u002Flerna.js.org\u002F\"\u003ELerna\u003C\u002Fa\u003E is that it \u003Ca href=\"https:\u002F\u002Fgist.github.com\u002Fbogas04\u002F8c9702aba064b03b1162a0058c7b8f98\"\u003Edoesn’t\u003C\u002Fa\u003E want private packages to be part of the \u003Ccode\u003Epackage-lock.json.\u003C\u002Fcode\u003E This means we can’t just simply use \u003Ccode\u003Enpm ci\u003C\u002Fcode\u003E. We use this bash script to get past that.\u003Ch3\u003EThe happy part.\u003C\u002Fh3\u003EWithin a few months of making this change, we tippled the number of packages in our Monorepo. We also saw much more work done on the linting front, leading to a more consistent codebase.\u003Cbr \u002F\u003EThe linter is common to entire Monorepo, and each new rule affects all the packages.\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003E\u003Cstrong\u003Econfig\u003C\u002Fstrong\u003E (webpack config as a package, reused by mweb and dweb)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Eui\u003C\u002Fstrong\u003E (a package to create common patterns of design to be used in mobile and desktop, thus enabling us to work on creating a Swiggy’s design system)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Epayments\u003C\u002Fstrong\u003E (a package of Swiggy’s payments page, used by multiple tenants)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Ereviews\u003C\u002Fstrong\u003E (a package of Swiggy’s Ratings and Reviews page and components, used by mweb and dweb)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Ehelpers\u003C\u002Fstrong\u003E (a package of common reusable logic, something like lodash)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Edaily\u003C\u002Fstrong\u003E (swiggydaily.com, reuses 2 components from mweb)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Ecache\u003C\u002Fstrong\u003E (a caching module used by mweb and dweb)\u003C\u002Fli\u003E\u003Cli\u003E\u003Cstrong\u003Erestaurant-url\u003C\u002Fstrong\u003E (a restaurant slug generator, multiple tenants)\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cbr \u002F\u003E\u003Cimg src=\"img\u002Fblog\u002F1__kvwGrM__62LBXWLHxH__QwGw.png\" alt=\"Image credits: undraw\"\u003E\u003Cbr \u002F\u003EI think that giving the option to easily create a new package incentivizes developers to think in more modular terms. They don’t think in the context of an app but rather in a more general way.\u003Cbr \u002F\u003EIt also discourages them from touching modules that are used by multiple tenants, and use \u003Ca href=\"https:\u002F\u002Fsemver.org\u002F\"\u003Esemantic versioning\u003C\u002Fa\u003E appropriately.\u003Cbr \u002F\u003EThe benefits we are seeing out of this are just amazing:\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003EWriting the same fix for dweb and mweb is faster, as it’s just one commit.\u003C\u002Fli\u003E\u003Cli\u003ENo more \u003Ccode\u003Enpm link\u003C\u002Fcode\u003E mess.\u003C\u002Fli\u003E\u003Cli\u003EReviewing a fix for both dweb and mweb is faster, as it’s just one Pull Request on one repository by one team member.\u003C\u002Fli\u003E\u003Cli\u003EReusing and updating build pipeline is much more seamless.\u003C\u002Fli\u003E\u003Cli\u003EUpdating major dependencies\u002Flint rules is super easy.\u003C\u002Fli\u003E\u003Cli\u003EThe collocation of code encourages developers to copy-paste less and reuse more.\u003C\u002Fli\u003E\u003Cli\u003EWriting reusable modules becomes easier, leading to better software engineering.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003EThe sad part.\u003C\u002Fh3\u003EBut it ain’t all fun. Our PR section is a bit noisier. It’s not like we’re somehow writing more code, but that changes to any package comes to spotlight and doesn’t get silently updated.\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003EToo many packages lead to longer bootstrap times.\u003C\u002Fli\u003E\u003Cli\u003ELeveraging the benefits of Monorepo takes time.\u003C\u002Fli\u003E\u003Cli\u003EThe code navigation is slightly slower. Developers are now opening individual packages to work around that.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cbr \u002F\u003E\u003Cstrong\u003EUpdate:\u003C\u002Fstrong\u003E There’s one more point I would like to touch upon. Our approach currently colocates applications with libraries. ‘mweb’ is a private package in the sense it isn’t published to our npm registry, however ‘ui’ is a public package that can be consumed by mulitple tenants. This leads to heterogeneity in the monorepo. We are okay with this mix as\u003Cbr \u002F\u003E\u003Cul\u003E\u003Cli\u003Eit reduces friction of local development (no npm links).\u003C\u002Fli\u003E\u003Cli\u003Ecolocation leads to easy refactors and library creations.\u003C\u002Fli\u003E\u003Cli\u003Ecode review is simpler when it’s all one repository.\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Ch3\u003EThe verdict.\u003C\u002Fh3\u003ESo far we’re seeing Monorepo architecture a better fit for our growing codebase and team. It also impacts the way we design new libraries and components, often promoting clearer separations of concerns.\u003Cbr \u002F\u003E\u003Cimg src=\"img\u002Fblog\u002F1__O3UIYiDjYTXMAZd7GBMwVg.png\" alt=\"Image credits: undraw\"\u003E\u003Cbr \u002F\u003EShould you use monorepo? Like all things, it depends on TM! I hope this blog gave enough insight to you as to why we started using a Monorepo, and how it’s benefiting us.\u003Cbr \u002F\u003E\u003Cblockquote\u003EDISCLAIMER: We don’t advocate for any of the tools, libraries, coding practices or software development philosophies mentioned here. You are welcome to read, learn, accept, reject and critique however you see fit.\u003C\u002Fblockquote\u003E"}}}("[]"))]};if('serviceWorker' in navigator)navigator.serviceWorker.register('/service-worker.js');var s=document.createElement("script");try{new Function("if(0)import('')")();s.src="/client/client.9a87ca2c.js";s.type="module";s.crossOrigin="use-credentials";}catch(e){s.src="/client/shimport@1.0.1.js";s.setAttribute("data-main","/client/client.9a87ca2c.js")}document.head.appendChild(s)</script> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-110963096-1"></script> <script> window.dataLayer = window.dataLayer || [];
		function gtag() { dataLayer.push(arguments); }
		gtag('js', new Date());

		gtag('config', 'UA-110963096-1');

		(function (d, s, scripts) {
			var js,
				fjs = d.getElementsByTagName(s)[0];
			for (var i = 0; i < scripts.length; i++) {
				if (!d.getElementById(scripts[i].id)) {
					js = d.createElement(s);
					js.id = scripts[i].id;
					js.src = scripts[i].url;
					fjs.parentNode.insertBefore(js, fjs);
				}
			}
		})(document, "script", [
			{ id: "google-platform", url: "//apis.google.com/js/platform.js" }
		]); </script> 